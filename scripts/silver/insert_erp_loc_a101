SELECT replace([cid], '-', '') as cid
      ,[cntry]
  FROM [DataWarehouse].[bronze].[erp_loc_a101]


select distinct cid from [DataWarehouse].[bronze].[erp_loc_a101]

---check connection
SELECT replace([cid], '-', '') as cid
      ,[cntry]
  FROM [DataWarehouse].[bronze].[erp_loc_a101]
where replace([cid], '-', '') not in (select distinct cst_key from silver.crm_cust_info)

---check  consistency
select distinct cntry from [DataWarehouse].[bronze].[erp_loc_a101] order by cntry 

SELECT replace([cid], '-', '') as cid
      ,case when trim(cntry) = 'DE' then 'Germany'
            when trim(cntry) in ('US', 'USA') then 'United States'
            when trim(cntry) = ' ' or cntry is null then 'n/a'
        else trim(cntry)
       end cntry
FROM [DataWarehouse].[bronze].[erp_loc_a101]


---insert into
insert into [silver].[erp_loc_a101](
cid
,cntry
)
SELECT replace([cid], '-', '') as cid
      ,case when trim(cntry) = 'DE' then 'Germany'
            when trim(cntry) in ('US', 'USA') then 'United States'
            when trim(cntry) = ' ' or cntry is null then 'n/a'
        else trim(cntry)
       end cntry
FROM [DataWarehouse].[bronze].[erp_loc_a101]
